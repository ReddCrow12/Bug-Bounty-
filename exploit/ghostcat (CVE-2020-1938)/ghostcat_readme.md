# Ghostcat Exploit Tool (CVE-2020-1938)

A Python-based security testing tool for identifying and exploiting the Ghostcat vulnerability (CVE-2020-1938) in Apache Tomcat servers.

## ‚ö†Ô∏è Disclaimer

This tool is intended for **authorized security testing and educational purposes only**. Only use this tool on systems you own or have explicit written permission to test. Unauthorized use of this tool is illegal and unethical.

## About Ghostcat (CVE-2020-1938)

Ghostcat is a critical vulnerability affecting Apache Tomcat servers that allows attackers to:
- Read arbitrary files from the web application
- Potentially upload malicious files (webshells)
- Execute remote code on vulnerable servers

The vulnerability exists in the Apache JServ Protocol (AJP) connector, which is enabled by default on port 8009 in many Tomcat configurations.

## Features

- **Vulnerability Detection**: Automatically detect if a target is vulnerable to Ghostcat
- **File Reading**: Read sensitive files like `WEB-INF/web.xml` and configuration files
- **Connection Testing**: Verify target accessibility and Tomcat presence
- **Verbose Logging**: Detailed output for debugging and analysis
- **Color-coded Output**: Easy-to-read status messages with timestamps

## Requirements

### Python Dependencies
```bash
pip install -r requirements.txt
```

**Required packages:**
- `requests`
- `urllib3`
- `colorama`

### System Requirements
- Python 3.6+
- Network access to target systems
- Permission to test target systems

## Installation

1. Clone or download the script
2. Install dependencies:
   ```bash
   pip install requests urllib3 colorama
   ```
3. Make the script executable:
   ```bash
   chmod +x ghostcat_exploit.py
   ```

## Usage

### Basic Vulnerability Check
```bash
python3 ghostcat_exploit.py -t https://target.example.com -c
```

### Read Specific File
```bash
python3 ghostcat_exploit.py -t https://target.example.com -f WEB-INF/web.xml
```

### Custom AJP Port
```bash
python3 ghostcat_exploit.py -t https://target.example.com -p 8010 -c
```

### Verbose Output
```bash
python3 ghostcat_exploit.py -t https://target.example.com -v -c
```

## Command Line Options

| Option | Description | Example |
|--------|-------------|---------|
| `-t, --target` | Target URL (required) | `https://example.com` |
| `-p, --port` | AJP port (default: 8009) | `-p 8010` |
| `-f, --file` | File to read from target | `-f WEB-INF/web.xml` |
| `-c, --check` | Only check vulnerability | `-c` |
| `-v, --verbose` | Enable verbose output | `-v` |
| `-u, --upload` | File to upload (experimental) | `-u shell.jsp` |
| `-d, --data` | Data for uploaded file | `-d "shell content"` |

## Examples

### 1. Quick Vulnerability Scan
```bash
python3 ghostcat_exploit.py -t http://vulnerable-tomcat.com -c
```

### 2. Read Web Application Configuration
```bash
python3 ghostcat_exploit.py -t http://vulnerable-tomcat.com -f WEB-INF/web.xml -v
```

### 3. Test Multiple Targets
```bash
# Create a simple bash loop
for target in target1.com target2.com target3.com; do
    echo "Testing $target"
    python3 ghostcat_exploit.py -t http://$target -c
done
```

## Understanding the Output

### Status Messages
- **üîµ INFO**: General information and progress updates
- **üü¢ SUCCESS**: Successful operations (connections, file reads)
- **üî¥ ERROR**: Failed operations or errors
- **üü° WARNING**: Potential vulnerabilities or important notices

### Vulnerability Indicators
- Target responds to AJP protocol requests
- Successful file reading from protected directories
- Server banner indicates Apache Tomcat

## Common Target Files

When using the `-f` option, try these common sensitive files:

```bash
# Configuration files
WEB-INF/web.xml
WEB-INF/classes/application.properties
META-INF/context.xml

# Tomcat specific
conf/server.xml
conf/tomcat-users.xml
conf/web.xml

# Application files
WEB-INF/classes/config.properties
WEB-INF/spring-context.xml
```

## Remediation

If you find systems vulnerable to Ghostcat:

1. **Immediate**: Disable or secure the AJP connector
2. **Update**: Upgrade to patched Tomcat versions:
   - 9.0.31+
   - 8.5.51+
   - 7.0.100+
3. **Configure**: If AJP is needed, bind to localhost only
4. **Firewall**: Block external access to port 8009
5. **Monitor**: Implement logging for AJP connections

## Troubleshooting

### Connection Issues
```bash
# Test basic connectivity first
telnet target.com 8009
nc -zv target.com 8009
```

### SSL/TLS Warnings
The tool disables SSL warnings by default. For production testing, consider enabling SSL verification.

### Permission Denied
Ensure you have permission to test the target systems and that firewall rules allow connections to the AJP port.

## Legal and Ethical Considerations

- ‚úÖ **Authorized Testing**: Only test systems you own or have written permission to test
- ‚úÖ **Bug Bounty Programs**: Use within scope of authorized bug bounty programs
- ‚úÖ **Educational Use**: Learning about security vulnerabilities in controlled environments
- ‚ùå **Unauthorized Access**: Never test systems without explicit permission
- ‚ùå **Malicious Use**: Do not use for illegal activities or to cause harm

## References

- [CVE-2020-1938 Details](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1938)
- [Apache Tomcat Security Advisories](https://tomcat.apache.org/security.html)
- [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/)

## Contributing

This tool is for educational and authorized security testing. If you find bugs or have improvements:

1. Ensure changes maintain ethical use focus
2. Test thoroughly in controlled environments
3. Document any new features clearly

## License

This tool is provided for educational and authorized security testing purposes. Users are responsible for ensuring compliance with applicable laws and regulations.

---

**Remember**: With great power comes great responsibility. Use this tool ethically and legally.